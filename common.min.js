function cacheRequest(n,t,i){i="requestCache."+(i||"default")+"."+n;chrome.storage.local.get(i,function(r){var u=r[i];u&&u.time+settings.cacheTimeout*864e5>(new Date).getTime()?t(u.data,!0):$.getJSON(n).success(function(n){r[i]={time:(new Date).getTime(),data:n};chrome.storage.local.set(r);t(n,!0)}).error(function(){t(null,!1)})})}function hasZh(n){return(n.match(/[\u4e00-\u9fa5]/g)||[]).length}function hasSpace(n){return(n.match(/\s+/g)||[]).length}function doubleEncode(n){return n?encodeURIComponent(encodeURIComponent(n)):""}function doubleDecode(n){return n?decodeURIComponent(decodeURIComponent(n)):""}function encodeHtml(n){var t=document.createElement("div");return t.innerText=n,t.innerHTML}function decodeHtml(n){var t=document.createElement("div");return t.innerHTML=n,t.innerText}(function(){function r(n){n.noResult=function(n){return!(this.definitions&&this.definitions.length||this.webDefinitions&&this.webDefinitions.length||this.translation&&this.translation.text&&this.translation.text!=this.query||n&&this.synonyms&&this.synonyms.length)};n.onlyTranslation=function(n){return this.translation&&this.translation.text&&this.translation.text!=this.query&&!(this.definitions&&this.definitions.length||this.webDefinitions&&this.webDefinitions.length||n&&this.synonyms&&this.synonyms.length)}}function u(n,t){function l(n){var f,e,c,o,l;if(!h){u.unshift(n);n:for(f=0;f<u.length;f++){for(e=u[f],c=e.dependencies,o=0;o<c.length;o++)if(l=c[o],r[l].ready)c.splice(o--,1);else continue n;if(u.splice(f--,1),s--,e.exec(),t(!s||e.complete,i),e.complete){h=!0;break}}}}function a(t,i){i&&(r[i]=t);t.ready=!1;cacheRequest(t.url.replace(/\$query\b/g,encodeURIComponent(n)),function(n){t.process(n,function(n){t.ready=!0;l(n)})});s++}var i={error:!1,query:n,wordsbookStatus:undefined,headword:undefined,phonetics:undefined,audio:undefined,tenses:undefined,synonyms:undefined,definitions:undefined,webDefinitions:undefined,translation:undefined,bingSearchUrl:"http://www.bing.com/search?q="+encodeURIComponent(n)},r={baiduTrans:{url:"http://openapi.baidu.com/public/2.0/bmt/translate?client_id=WoxFqsePq4my7ky741GtGSIq&q=$query&from=auto&to=auto",process:function(n,t){var r={complete:!1,dependencies:[],exec:function(){i.translation=n?{text:n.trans_result[0].dst,src:n.from,to:n.to}:undefined}};t(r)}},bingDict:{url:"http://dict.bing.com.cn/api/http/v2/3A7B446E1F9244378B7141B73118977D/en-us/zh-cn/lexicon/?format=application/json&q=$query",process:function(t,r){var u={complete:!1,dependencies:[],exec:function(){var r,u,c;if(t.LEX){var s=t.LEX,h=s.HW.V,l=s.HW.SIG;if(i.phonetics=[],i.audio={},r=s.PRON,r)for(u=0;u<r.length;u++)r[u].L=="PY"?i.phonetics.push({text:r[u].V,poss:[]}):r[u].L!="US"||i.phonetics.length||(i.phonetics.push({text:"/"+r[u].V+"/",poss:[]}),i.audio.us="http://media.engkoo.com:8129/en-us/"+l+".mp3");i.synonyms=f(s.THES);c=e(n,s);i.definitions=c.definitions;i.webDefinitions=c.webDefinitions;i.tenses=o(s)}i.headword={text:h,beautified:h};i.wordsbookStatus=/^[a-z]+(?:['-][a-z]+)?$/i.test(h)?"querying":undefined}};r(u)}}},u=[],s=0,h=!1;for(var c in r)r.hasOwnProperty(c)&&a(r[c]);return i}function f(n){var r=[],i,t;if(!n)return r;for(i=0;i<n.length;i++)t=n[i],t.S&&t.S.length&&r.push({pos:t.POS,items:t.S});return r}function e(n,i){var h,o,u,c,f,e,r;if(!i)return{};var s=[],a=[],v=s.hash={},l=i.C_DEF;if(l){for(f={lang:t(n)?"en":"zh",poss:[]},e=0;e<l.length;e++)if(h=l[e],o={pos:h.POS,meanings:[]},o.pos=="web")for(u=h.SEN,r=0;r<u.length;r++)u[r].D&&a.push({text:u[r].D,url:u[r].URL});else{for(u=h.SEN,r=0;r<u.length;r++)o.meanings.push(u[r].D);f.poss.push(o)}f.poss.length&&(v[f.lang]=!0,s.push(f))}if(c=i.H_DEF,c){for(f={lang:t(n)?"zh":"en",poss:[]},v[f.lang]=!0,e=0;e<c.length;e++){var y=c[e],o={pos:y.POS,meanings:[]},u=y.SEN;for(r=0;r<u.length;r++)o.meanings.push(u[r].D);f.poss.push(o)}s.push(f)}return{definitions:s,webDefinitions:a}}function o(n){var u=n.INF,i,t;if(u){var s=[],f={},h=Object.prototype.hasOwnProperty;for(i=0;i<u.length;i++){var e=u[i],r=e.IE,o=lang.tenses[e.T]||e.T;h.call(f,r)?(t=f[r],t.labels.indexOf(o)<0&&t.labels.push(o)):(t={text:r,labels:[o]},f[r]=t,s.push(t))}return s}return undefined}function t(n){return(n.match(/[\u4e00-\u9fa5]/g)||[]).length}function s(n){var t=document.createElement("div");return t.innerHTML=n,t.innerText}self.splitWords=function(n,t,i){var r,u,e,o,h,f;for(i&&(n=s(n)),n=n.replace(/\s{2,}/g," "),r=[],u=/[a-z0-9-]+/ig;n;)u.lastIndex=0,e=u.exec(n),e?(o=u.lastIndex-e[0].length,o>0&&r.push({isWord:!1,text:n.substr(0,o)}),r.push({isWord:!0,text:e[0]}),n=n.substr(u.lastIndex)):(r.push({isWord:!1,text:n}),n="");for(h="",f=0;f<r.length;f++)h+='<span class="'+t+"-"+r[f].isWord+'">'+encodeHtml(r[f].text)+"<\/span>";return h};self.fetchResult=u;self.addResultMethods=r;var n=new function(){this.call=function(n,t,r){if(!options.email||!options.password){r(null,!1);return}t.email=options.email;t.password=options.password;$.post(i+n,t).done(function(n){n.error?n.error>2e3&&n.error<3e3?r(null,!1):r(null,!0):r(n,!0)}).fail(function(){r(null,!0)})}},i="https://api.wordsbaking.com/";self.wordsbookExists=function(t,i){n.call("wordsbook/exists",{word:t},function(n,t){i(t,n&&n.data.exists)})};self.addToWordsbook=function(t,i){n.call("wordsbook/add",{word:t},function(n,t){i(t,!!n)})};self.removeFromWordsbook=function(t,i){n.call("wordsbook/remove",{word:t},function(n,t){i(t,!!n)})}})();
/*
//# sourceMappingURL=common.min.js.map
*/