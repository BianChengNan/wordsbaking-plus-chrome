$(function(){var n=$("#phrase-input").mousedown(function(n){document.activeElement!=this&&(n.preventDefault(),this.focus())}).focus(function(){this.select()}).focus().get(0);document.addEventListener("keydown",function(t){if(document.activeElement!=n)if(t.keyCode==13&&document.activeElement!=$("#define-button").get(0))n.focus();else if(t.keyCode==189)history.go(-1),t.preventDefault();else if(t.keyCode==187)history.go(1),t.preventDefault();else if(t.keyCode==8){n.focus();var i=n.value.length;n.setSelectionRange(i,i)}else(t.altKey||t.ctrlKey||t.metaKey)&&t.keyCode!=86||n.focus()},!0)});var MainController=["$scope","$location","$route","$routeParams","$locale",function(n,t,i,r){function e(){window.open(chrome.extension.getURL("options.html"))}function o(){n.phrase=doubleDecode(r.phrase);h()}function h(){$("#definition-wrapper").scrollTop(0);$("#phrase-input").blur();var t=n.phrase;if(s=t,!t){n.status=u.init;return}n.status=u.loading;n.result=null;fetchResult(t,function(i,r){t==s&&(addResultMethods(r),r.wordsbookStatus&&wordsbookExists(r.headword.text,function(t,i){r.wordsbookStatus=t?i?"added":"addable":"setup";n.$apply()}),n.result=r,i&&(n.status=r.noResult(!0)?u.nothing:r.error?u.error:u.ready,options.autoAudio&&n.playAudio()),n.$apply())})}var u,f,s;n.$routeParams=r;n.$location=t;u=n.Status={init:0,loading:1,ready:2,nothing:3,error:4};n.status=u.init;n.lang=lang;n.settings=settings;n.result=null;n.$watch("result.audio.us",function(n){f=n?new Audio(n):null});n.playAudio=function(){setTimeout(function(){f&&(f.src=f.src,f.play())},0)};n.define=function(){var i="/"+doubleEncode($.trim(n.phrase));i!=t.path()?t.path(i):o()};$(document).delegate(".word-true","click",function(){n.phrase=$(this).text();n.define();n.$apply()}).delegate("#headword-wrapper.wb-addable .wordsbook-button","click",function(){var t=n.result;t.wordsbookStatus="adding";n.$apply();addToWordsbook(t.headword.text,function(i,r){t.wordsbookStatus=i?r?"added":"addable":"setup";n.$apply();i||e()})}).delegate("#headword-wrapper.wb-added .wordsbook-button","click",function(){var t=n.result;t.wordsbookStatus="removing";n.$apply();removeFromWordsbook(t.headword.text,function(i,r){t.wordsbookStatus=i?r?"addable":"added":"setup";n.$apply();i||e()})}).delegate("#headword-wrapper.wb-setup .wordsbook-button","click",function(){e()});n.$on("$routeChangeSuccess",o);chrome.tabs.query({active:!0,currentWindow:!0},function(t){try{chrome.tabs.sendMessage(t[0].id,{type:"getSelection"},function(t){t&&(n.phrase=t.text,n.define(),n.$apply())})}catch(i){}})}];angular.module("popup",["ngRoute"],["$routeProvider",function(n){n.when("/",{controller:MainController}).when("/:phrase",{controller:MainController})}]).directive("clickableWords",function(){return function(n,t,i){n.$watch(i.clickableWords,function(n){if(typeof n=="string"){var i=splitWords(n,"word",!0);t.html(i)}})}});
/*
//# sourceMappingURL=popup.min.js.map
*/